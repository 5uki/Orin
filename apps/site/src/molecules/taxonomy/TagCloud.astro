---
/**
 * TagCloud Component
 *
 * Displays a cloud of tags with counts, sorted by popularity.
 *
 * @module molecules/taxonomy
 */
import { tagToSlug } from '../../atoms';

interface Props {
  tags: Map<string, number>;
  limit?: number;
}

const { tags, limit } = Astro.props;

// Sort tags by count (descending) and optionally limit
const sortedTags = [...tags.entries()].sort((a, b) => b[1] - a[1]).slice(0, limit);
---

<div class="tag-cloud">
  <h3 class="tag-cloud-title">标签</h3>
  <div class="tag-list">
    {
      sortedTags.map(([tag, count]) => (
        <a href={`/tags/${tagToSlug(tag)}`} class="tag-item">
          <span class="tag-name">{tag}</span>
          <span class="tag-count">{count}</span>
        </a>
      ))
    }
  </div>
</div>

<style>
  .tag-cloud {
    padding: var(--space-4);
    background-color: var(--color-bg-secondary);
    border-radius: var(--radius-lg);
  }

  .tag-cloud-title {
    font-size: var(--text-sm);
    font-weight: var(--font-semibold);
    color: var(--color-fg-muted);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin: 0 0 var(--space-3) 0;
  }

  .tag-list {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-2);
  }

  .tag-item {
    display: inline-flex;
    align-items: center;
    gap: var(--space-1);
    padding: var(--space-1) var(--space-3);
    background-color: var(--color-bg);
    border: 1px solid var(--color-border-light);
    border-radius: var(--radius-full);
    font-size: var(--text-sm);
    color: var(--color-fg-secondary);
    text-decoration: none;
    transition:
      border-color var(--transition-fast),
      color var(--transition-fast);
  }

  .tag-item:hover {
    border-color: var(--color-accent);
    color: var(--color-accent);
  }

  .tag-name {
    font-weight: var(--font-medium);
  }

  .tag-count {
    font-size: var(--text-xs);
    color: var(--color-fg-muted);
  }
</style>
